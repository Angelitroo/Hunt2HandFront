<ion-content>
  <app-buscador-menu (searchEvent)="onSearch($event.searchValue)"></app-buscador-menu>

  <div class="slides-container">
    <div class="slide" *ngFor="let categoria of categorias" (click)="getProductoByCategoria(categoria)">
      <ng-container *ngIf="productosPorCategoria[categoria]?.length">
        <label class="chip">
          <label class="label">{{ categoria }}</label>
        </label>
      </ng-container>
    </div>
  </div>

  <ng-container *ngFor="let categoria of categorias">
    <ion-list class="grid1" *ngIf="productosPorCategoria[categoria]?.length">
      <ion-grid>
        <ion-row>
          <ion-col size="12">
            <h2>{{ categoria }}</h2>
          </ion-col>
          <ion-col size="6" size-md="6" size-lg="3" *ngFor="let producto of productosPorCategoria[categoria]">
            <div class="card" (click)="flipBack($event)">
              <div class="card-inner">
                <div class="card-front">
                  <ion-img [src]="producto.imagen" class="product-image"></ion-img>
                  <ion-row>
                    <ion-col size="9">
                      <ion-card-title class="product-name">
                        <b>{{ producto.nombre }}</b>
                      </ion-card-title>
                    </ion-col>
                    <ion-col size="3">
                      <ion-card-title class="price-container">
                        {{ producto.precio + "â‚¬" }}
                      </ion-card-title>
                    </ion-col>
                  </ion-row>
                </div>
                <div class="card-back">
                  <ion-card-subtitle>{{ producto.descripcion }}</ion-card-subtitle>
                  <ion-card-subtitle>{{ producto.categoria }}</ion-card-subtitle>
                  <ion-card-subtitle>{{ perfiles[producto.perfil]?.nombre }}</ion-card-subtitle>
                  <ion-buttons>
                    <ion-button fill="clear" class="like-button" (click)="toggleFavorito($event, producto.id)">
                      <ion-icon
                        [name]="favoritos[producto.id] ? 'heart' : 'heart-outline'"
                        [class.heart]="favoritos[producto.id]"
                        [class.heart-outline]="!favoritos[producto.id]">
                      </ion-icon>
                    </ion-button>
                  </ion-buttons>
                  <ion-button (click)="verProducto($event, producto.id)">Ver Producto</ion-button>
                </div>
              </div>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-list>
  </ng-container>

  <ion-infinite-scroll (ionInfinite)="onIonInfinite($event)">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>

  <app-menu-inferior></app-menu-inferior>
</ion-content>
